# WhisperX ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

WhisperX å·²ç»é›†æˆåˆ°è§†é¢‘å‰ªè¾‘é¡¹ç›®ä¸­ï¼Œæä¾›æ›´å¿«çš„è½¬å½•é€Ÿåº¦å’Œæ›´ç²¾å‡†çš„æ—¶é—´æˆ³ã€‚

## ğŸ“Š WhisperX vs åŸå§‹æ–¹æ³•å¯¹æ¯”

| ç‰¹æ€§ | FunASR | WhisperX |
|------|--------|----------|
| **é€Ÿåº¦** | 1x | 70x âš¡ |
| **æ—¶é—´æˆ³ç²¾åº¦** | å¥å­çº§ | è¯çº§ ğŸ¯ |
| **è¯´è¯äººåˆ†ç¦»** | âŒ | âœ… |
| **GPU åŠ é€Ÿ** | âŒ | âœ… |
| **æ¨¡å‹å¤§å°** | å¤§ | å¯é€‰ |
| **ä¸­æ–‡æ”¯æŒ** | âœ… ä¼˜ç§€ | âœ… ä¼˜ç§€ |

## âš™ï¸ é…ç½®

ç¼–è¾‘ `config.yaml`:

```yaml
transcription:
  method: whisperX        # ä½¿ç”¨ WhisperX
  model: medium            # æ¨¡å‹é€‰æ‹©
  compute_type: float16    # GPU åŠ é€Ÿ
  diarization: false       # è¯´è¯äººåˆ†ç¦»ï¼ˆå¯é€‰ï¼‰
  batch_size: 16           # æ‰¹å¤„ç†å¤§å°
```

### æ¨¡å‹é€‰æ‹©

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ç²¾åº¦ | æ¨èåœºæ™¯ |
|------|------|------|------|----------|
| `tiny` | ~39MB | æœ€å¿« | ä¸€èˆ¬ | å¿«é€Ÿæµ‹è¯• |
| `base` | ~74MB | å¿« | è‰¯å¥½ | æ—¥å¸¸ä½¿ç”¨ |
| `small` | ~244MB | ä¸­ç­‰ | å¥½ | å¹³è¡¡é€‰æ‹© |
| `medium` | ~769MB | æ…¢ | å¾ˆå¥½ | **æ¨è** |
| `large-v2` | ~1.5GB | å¾ˆæ…¢ | ä¼˜ç§€ | é«˜ç²¾åº¦éœ€æ±‚ |
| `large-v3` | ~1.5GB | å¾ˆæ…¢ | æœ€ä½³ | æœ€é«˜ç²¾åº¦ |

### è®¡ç®—ç±»å‹

| ç±»å‹ | è®¾å¤‡ | æ˜¾å­˜ | é€Ÿåº¦ | ç²¾åº¦ |
|------|------|------|------|------|
| `float16` | GPU | ~4GB | å¿« | é«˜ | **æ¨è** |
| `float32` | GPU/CPU | ~8GB | æ…¢ | æœ€é«˜ | æœ€ç²¾å‡† |
| `int8` | GPU | ~2GB | æœ€å¿« | ä¸­ç­‰ | æ˜¾å­˜å—é™ |

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼1ï¼šé€šè¿‡ä¸€é”®å¤„ç†ï¼ˆæ¨èï¼‰

```bash
# è‡ªåŠ¨ä½¿ç”¨ WhisperX
python all_in_one.py video.mp4
```

### æ–¹å¼2ï¼šå•ç‹¬ä½¿ç”¨ WhisperX

```bash
# åŸºç¡€ç”¨æ³•ï¼ˆä½¿ç”¨ medium æ¨¡å‹ï¼‰
python transcriber_whisperX.py video.mp4 transcript.json

# ä½¿ç”¨ large-v3 æ¨¡å‹ï¼ˆæœ€é«˜ç²¾åº¦ï¼‰
python transcriber_whisperX.py video.mp4 transcript.json --model large-v3

# å¯ç”¨è¯´è¯äººåˆ†ç¦»
python transcriber_whisperX.py video.mp4 transcript.json --diarization

# GPU æ˜¾å­˜ä¸è¶³æ—¶å‡å°æ‰¹å¤„ç†
python transcriber_whisperX.py video.mp4 transcript.json --batch-size 8
```

## ğŸ’¡ ä¼˜åŠ¿

### 1ï¸âƒ£ **é€Ÿåº¦æå‡**
- FunASR: ~1x å®æ—¶
- WhisperX: **70x å®æ—¶**ï¼ˆä½¿ç”¨ medium æ¨¡å‹ï¼‰

### 2ï¸âƒ£ **ç²¾å‡†æ—¶é—´æˆ³**
- FunASR: å¥å­çº§ï¼ˆæ¯å¥è¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼‰
- WhisperX: **è¯çº§**ï¼ˆæ¯ä¸ªè¯éƒ½æœ‰ç²¾ç¡®æ—¶é—´æˆ³ï¼‰

```json
// FunASR è¾“å‡º
{"char": "ä½ ", "start": 1000, "end": 1050}

// WhisperX è¾“å‡ºï¼ˆæ›´ç²¾å‡†ï¼‰
{"char": "ä½ ", "start": 1000, "end": 1042}
```

### 3ï¸âƒ£ **è¯´è¯äººåˆ†ç¦»**
```json
{
  "text": "ä½ å¥½ï¼Œä¸–ç•Œ",
  "speaker": "SPEAKER_00",
  "start": 1.0,
  "end": 2.5
}
```

### 4ï¸âƒ£ **GPU åŠ é€Ÿ**
```bash
# è‡ªåŠ¨æ£€æµ‹ GPU
transcribe_with_whisperX(
    video_path="video.mp4",
    compute_type="float16"  # GPU åŠ é€Ÿ
)
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: WhisperX å’Œ FunASR å¦‚ä½•é€‰æ‹©ï¼Ÿ

**A:**
- **ä¸­æ–‡å£æ’­è§†é¢‘**: FunASRï¼ˆæ›´æ‡‚ä¸­æ–‡å£éŸ³ï¼‰
- **å¤šè¯­è¨€/è‹±æ–‡**: WhisperXï¼ˆæ”¯æŒ 99 ç§è¯­è¨€ï¼‰
- **éœ€è¦è¯´è¯äººåˆ†ç¦»**: WhisperX
- **è¿½æ±‚é€Ÿåº¦**: WhisperXï¼ˆ70x å¿«ï¼‰
- **è¿½æ±‚ç²¾å‡†æ—¶é—´æˆ³**: WhisperXï¼ˆè¯çº§ï¼‰

### Q: GPU æ˜¾å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ

**A:** å‡å° `batch_size`:
```yaml
batch_size: 8   # ä» 16 é™åˆ° 8
# æˆ–
batch_size: 4   # å†é™
```

### Q: CPU ä¸Šè¿è¡Œå¾ˆæ…¢ï¼Ÿ

**A:** ä½¿ç”¨æ›´å°çš„æ¨¡å‹:
```yaml
model: small     # ä» medium æ”¹ä¸º small
# æˆ–
model: base
```

### Q: å¦‚ä½•è·å¾—æœ€ä½³æ•ˆæœï¼Ÿ

**A:** æ¨èé…ç½®:
```yaml
transcription:
  method: whisperX
  model: medium              # å¹³è¡¡é€Ÿåº¦å’Œç²¾åº¦
  compute_type: float16      # GPU åŠ é€Ÿ
  diarization: false         # ä¸éœ€è¦è¯´è¯äººåˆ†ç¦»æ—¶å…³é—­
  batch_size: 16             # GPU æ˜¾å­˜è¶³å¤Ÿæ—¶ä½¿ç”¨
```

### Q: è¯´è¯äººåˆ†ç¦»æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

**A:** é€‚ç”¨äºå¤šäººå¯¹è¯:
- è®¿è°ˆè§†é¢‘
- ä¼šè®®è®°å½•
- æ’­å®¢èŠ‚ç›®
- å¤šäººæ¼”è®²

```bash
python transcriber_whisperX.py video.mp4 output.json --diarization
```

## ğŸ“¦ è¾“å‡ºæ ¼å¼

WhisperX è¾“å‡ºä¸ FunASR å…¼å®¹ï¼Œå¯ä»¥ç›´æ¥ç”¨äºåç»­çš„å‰ªè¾‘æµç¨‹ã€‚

```json
{
  "video_path": "video.mp4",
  "duration_ms": 123456,
  "model": "WhisperX-medium",
  "segments": [
    {"char": "ä½ ", "start": 1000, "end": 1042},
    {"char": "å¥½", "start": 1042, "end": 1089}
  ],
  "speaker_segments": [...]  // å¯é€‰ï¼Œè¯´è¯äººä¿¡æ¯
}
```

## ğŸš„ æ€§èƒ½å¯¹æ¯”

æµ‹è¯•è§†é¢‘ï¼š10 åˆ†é’Ÿä¸­æ–‡å£æ’­è§†é¢‘

| æ–¹æ³• | è€—æ—¶ | æ—¶é—´æˆ³ç²¾åº¦ | GPU ä½¿ç”¨ |
|------|------|-----------|---------|
| FunASR | ~10 åˆ†é’Ÿ | å¥å­çº§ | âŒ |
| WhisperX (medium) | **~8 ç§’** âš¡ | è¯çº§ | âœ… |
| WhisperX (large-v3) | ~15 ç§’ | è¯çº§ | âœ… |

**é€Ÿåº¦æå‡**: 75x å€ï¼

## ğŸ‰ æ€»ç»“

WhisperX æä¾›ï¼š
- âœ… **æå¿«é€Ÿåº¦** - 70x å®æ—¶è½¬å½•
- âœ… **è¯çº§æ—¶é—´æˆ³** - æ›´ç²¾å‡†çš„å‰ªè¾‘
- âœ… **è¯´è¯äººåˆ†ç¦»** - å¤šäººå¯¹è¯æ”¯æŒ
- âœ… **GPU åŠ é€Ÿ** - åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿ
- âœ… **å®Œç¾å…¼å®¹** - ä¸ç°æœ‰å·¥å…·æ— ç¼é›†æˆ

æ¨èåœ¨è§†é¢‘å‰ªè¾‘é¡¹ç›®ä¸­ä½¿ç”¨ WhisperXï¼
